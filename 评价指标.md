# PR曲线和$F_1$ & ROC曲线和AUC



## PR

![PR](/Users/kane/Library/Mobile Documents/com~apple~CloudDocs/上岸宝典/ML/PR.png)

混淆矩阵

Conusion matrix

|                    | Actual  positive | Actual negative |
| :----------------: | :--------------: | :-------------: |
| Predicted positive |        TP        |       FP        |
| Predicted negative |        FN        |       TN        |


$$
P(precision)={TP\over TP+FP}\\
R(Recall)={TP\over {TP+FN}}\\
F_1={2\times P\times R \over P+R}
$$


* P-R曲线越靠近右上角性能越好
* PR曲线对数据分布比较敏感，不适合在不同数据分布下的模型对比。
* $F_1$ 值综合考虑了P值和R值
* $P、R$ 和$F$ 评价在信息检索中用的比较多，在机器学习中还有一种ROC曲线评价性能

## ROC

![ROC](/Users/kane/Library/Mobile Documents/com~apple~CloudDocs/上岸宝典/ML/ROC.png)
$$
TPR=Recall={TP\over {TP+FN}}\\
FPR={FP\over {TN+FP}}
$$
AUC的值就是ROC曲线下方围城区域的面积大小，如果分类器a的PR曲线或ROC曲线包围了分类器b对应的分类器曲线，那么分类器a的性能优于分类器b的性能

理想目标：$$TPR-1, FPR=0, 即（0，1）$$点，故ROC曲线越靠拢$(0,1)$ 点，越偏离45度对角线越好

* 优点：

  1. 兼顾正例和负例的权衡。因为TPR聚焦于正例，FPR聚焦于与负例，使其成为一个比较均衡的评估方法。

  2. 注意TPR用到的TP和FN同属P列，FPR用到的FP和TN同属N列，所以如果正负例比例或者说分布发生变化，也不会影响FPR和TPR，因为FPR与TPR不与正负例比例相关。

     

AUC定义：

* 普遍的定义是ROC曲线下的面积

* 分别随机从正负样本集中抽取一个正负样本，正样本的预测值大于负样本的概率
  $$
  AUC={\sum predpos>predneg \over positiveNum\cdot NegativeNum}
  $$
  



## 联系和不同

### 相同点：

* 从定义上，PR曲线的R值等于ROC曲线中的TPR值
* 都是用来评价分类模型的

### 不同点

* ROC曲线是单调的而PR不是
* 可以用AUC的值大小来评价分类起的好坏
* 正负样本分类失衡的情况下ROC曲线不变，而PR曲线会产生很大变化，PR更敏感

## 适用场景

* ROC曲线由于兼顾正例与负例，所以适用于评估分类器的整体性能，相比而言PR曲线完全聚焦于正例。
* 如果有多份数据且存在**不同的类别分布**，比如信用卡欺诈问题中每个月正例和负例的比例可能都不相同，这时候**如果只想单纯地比较分类器的性能且剔除类别分布改变的影响，则ROC曲线比较适合**，因为类别分布改变可能使得PR曲线发生变化时好时坏，这种时候难以进行模型比较；
* 如果想测试不同类别分布下对分类器的性能的影响，则PR曲线比较适合。
* 在类别不平衡问题下（分布是固定的），ROC曲线呈现一个过分乐观的效果估计（各个模型的ROC曲线差异不大），模型的好坏从ROC曲线很难看出来，这个时候PR曲线更好。