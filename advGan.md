# 天池比赛：Imagenet图像分类对抗攻击

目的：通过给图像增加有限的扰动，使分类器对图像分类错误。第一种是规定将某一种类的图像分类到规定的某一种，第二种是只要将该类图像分类到其他任意一种就行，每一种的得分不一样。

限制：每一个像素点的扰动是【-0.3，0.3】

* 用AdvGan网络产生扰动样本

* 生成器的网络结构和自编码器的网络结构是一样的，比如输入是229*229，输出也是229**229，然后网络里的每层是一个resnet结构

* 输出代表了样本的扰动值。判别器是对我们的原本图像加入了扰动点之后，输入到我们的判别器当中。判别器的目的是判别原图像和加了扰动的图像是不是同一个图像。这里用到的损失函数是MSE损失，将输出映射到0-1的值后，将原图像和扰动图像分别与0，1做MSE损失。

* 生成器和判别器不是同时进行的，当对判别器进行训练的时候，固定生成器，目的是训练优秀的判别器，从而区分原图和扰动图。当训练生成器的时候，固定判别器，此时将损失函数改为，扰动图像与1的MSE损失，目的是为了使扰动的图像与真实图像更接近。生成器和判别器是互相博弈，且互相进步的过程。

* 除此之外，advGan还加了一个防御器，也就是一个普通的分类器，目的是将扰动的图像传入到分类器后，让分类网络错误判断它。那损失函数是在原损失函数上加了负号，而将某类图像错误分类到另一个分类，也就是用的softmax之后的logloss。分类网络的权重是固定的。

* 为了使防御模型有更好的抵抗作用，我们这里将三个网络，Resnet101，vgg, inceptionv3，整合起来，一起防御，这样使得生成器生成的扰动有更好的效果。

  - resnet

    <img src="/Users/kanghaoyu/Library/Mobile Documents/com~apple~CloudDocs/上岸宝典/ML/resnet.jpg" alt="resnet" style="zoom:50%;" />

    <img src="/Users/kanghaoyu/Library/Mobile Documents/com~apple~CloudDocs/上岸宝典/ML/resnet_unit.png" alt="resnet_unit" style="zoom:50%;" />

    解决的问题：

    * 梯度消失的问题
    * 网络过深的话，顶层网络的输入输出值其实改变很小，这时候，通过加入skip connection将恒等映射变为残差映射，这种映射更容易学习。

  - vgg

    优点：

    * VGGNet的结构非常简洁，整个网络都使用了同样大小的卷积核尺寸（3x3）和最大池化尺寸（2x2）。
    * 几个小滤波器（3x3）卷积层的组合比一个大滤波器（5x5或7x7）卷积层好：同样的感受野下，网络更深，参数更少

  - InceptionV3

    不同尺度的卷积核之后的concat

* 训练模型，调整优化参数以及对抗损失，生成器损失，判别器损失， 扰动损失的权重占比：不同阶段损失权重是不一样的，通过实验发现，刚开始，对抗损失高一点，会更容易收敛。如果判别损失和生成器损失太高的话，因为图像和原图像太像，对抗损失很难下降。

  